# 多轮对话测试 - 快速开始

## 🚀 5分钟快速体验

### 步骤1：打开测试用例页面

访问：http://127.0.0.1:8000/pages/testcases.html

### 步骤2：创建多轮对话测试

1. 点击右上角"➕ 添加测试用例"
2. 填写基本信息：
   - 标题：`上下文记忆测试`
   - 分类：`对话能力`

3. 展开"多轮对话历史"区域：
   - 点击"添加用户消息"，输入：`我叫李明`
   - 点击"添加助手消息"，输入：`你好李明！很高兴认识你。有什么我可以帮助你的吗？`

4. 在"用户提示词"中输入：`请问我叫什么名字？`

5. 点击"保存"

### 步骤3：执行批量测试

1. 点击左侧导航"批量测试"
2. 选择刚创建的测试用例
3. 选择一个模型
4. 点击"开始测试"

### 步骤4：查看结果

系统会评估模型是否正确记住了用户的名字（李明）。

## 📋 更多测试场景

### 场景A：连续问答
```
历史：
- 用户：今天天气怎么样？
- 助手：今天多云，温度18-25度

当前：那明天呢？
```

### 场景B：任务延续
```
历史：
- 用户：请帮我写一封邮件
- 助手：好的，请问收件人是谁？
- 用户：张总

当前：邮件主题是季度总结
```

### 场景C：信息提炼
```
历史：
- 用户：我想去旅游
- 助手：请问您想去哪里？
- 用户：云南
- 助手：好的。预算大概多少？
- 用户：5000元左右

当前：帮我总结一下我的需求
```

## 🎯 测试技巧

1. **逐步增加复杂度**：从简单的2轮对话开始
2. **测试边界情况**：测试模型是否会混淆不同上下文
3. **评估记忆深度**：测试模型能记住多久以前的信息
4. **测试工具调用**：在多轮对话中测试工具的使用

## 🐛 常见问题

**Q: 对话历史为空时会怎样？**
A: 系统会自动退化为单轮对话模式

**Q: 可以添加多少轮对话？**
A: 理论上无限制，但注意模型的上下文长度限制（通常4k-128k tokens）

**Q: 评分机制如何工作？**
A: 与单轮测试相同，基于最后一轮的输出进行评分

**Q: 支持工具调用吗？**
A: 完全支持！可以在对话历史中包含工具调用记录

## 📊 界面说明

### 对话历史编辑器

- 🔵 蓝色背景 = 用户消息
- 🟢 绿色背景 = 助手消息
- ⬆️⬇️ 箭头 = 调整消息顺序
- 🗑️ 删除按钮 = 移除该条消息

### 测试用例列表

- 显示"💬 对话历史 (N轮)"徽章
- 点击展开可查看历史内容

## 🔗 相关文档

- 完整功能说明：`MULTI_ROUND_CONVERSATION.md`
- API文档：查看后端代码注释
- 数据库迁移：`migrate_add_conversation_history.py`
